## План: отображение процесса симуляции цифрового двойника

Цель: на странице симуляции показывать полный процесс (этапы, статусы, ошибки) для всех сервисов.

### 1) Контекст и источники истины
- ✅ Проверить локальные `AGENTS.md` в затронутых подкаталогах.
- ✅ Открыть ключевые документы по слоям:
  - `doc_ai/09_AI_AND_DIGITAL_TWIN`
  - `doc_ai/04_BACKEND_CORE`
  - `doc_ai/05_DATA_AND_STORAGE`

### 2) Модель событий симуляции
- ✅ Спроектировать таблицу `simulation_events`:
  - связи с симуляцией, зоной, сервисом;
  - этап, статус, сообщение, payload, timestamps.
- ✅ Определить набор этапов и статусов (минимальный обязательный).
- ✅ Обновить `doc_ai/05_DATA_AND_STORAGE/DATA_MODEL_REFERENCE.md`.

### 3) Запись событий в сервисах
- ✅ Laravel: добавить запись этапов в оркестратор симуляции.
- ✅ digital-twin + node-sim-manager: запись событий запуска/остановки.
- ✅ Подключить остальные сервисы к отправке событий:
  - mqtt-bridge
  - automation-engine
  - telemetry-aggregator
- ✅ Логи ошибок писать в события с деталями.

### 4) API и стрим событий
- ✅ Эндпоинт для выборки событий по симуляции.
- ✅ SSE для автообновления таймлайна.
- ✅ Фильтрация по сервису и уровню (info/error).

### 5) Фронтенд: таймлайн процесса
- ✅ На странице симуляции добавить блок "Процесс симуляции".
- ✅ Отображать этапы в виде таймлайна/статус-листа.
- ✅ Показ ошибок и деталей по клику.

### 6) Проверки
- ✅ Прогон в Docker (Laravel тесты по симуляции, unit тесты digital-twin).
- ✅ Прогон unit тестов сервисов (mqtt-bridge, automation-engine, telemetry-aggregator).
- ⏳ Проверка живого обновления и корректности этапов (ручной E2E прогон).
