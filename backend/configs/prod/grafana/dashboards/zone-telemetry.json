{
  "title": "Zone Telemetry",
  "tags": [
    "zones",
    "telemetry"
  ],
  "timezone": "browser",
  "schemaVersion": 16,
  "version": 1,
  "refresh": "15s",
  "panels": [
    {
      "id": 1,
      "title": "pH by Zone",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 0
      },
      "datasource": {
        "type": "postgres",
        "uid": "PostgreSQL"
      },
      "targets": [
        {
          "rawSql": "SELECT ts.ts::timestamp as time, ts.value::float, 'Zone ' || ts.zone_id::text || ' - ' || s.type as metric FROM telemetry_samples ts JOIN sensors s ON s.id = ts.sensor_id WHERE s.type = 'PH' AND ts.ts >= NOW() - INTERVAL '30 days' AND ts.ts <= NOW() ORDER BY ts.ts LIMIT 5000",
          "format": "time_series",
          "refId": "A"
        }
      ]
    },
    {
      "id": 2,
      "title": "EC by Zone",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 0
      },
      "datasource": {
        "type": "postgres",
        "uid": "PostgreSQL"
      },
      "targets": [
        {
          "rawSql": "SELECT ts.ts::timestamp as time, ts.value::float, 'Zone ' || ts.zone_id::text || ' - ' || s.type as metric FROM telemetry_samples ts JOIN sensors s ON s.id = ts.sensor_id WHERE s.type = 'EC' AND ts.ts >= NOW() - INTERVAL '30 days' AND ts.ts <= NOW() ORDER BY ts.ts LIMIT 5000",
          "format": "time_series",
          "refId": "A"
        }
      ]
    },
    {
      "id": 3,
      "title": "Temperature by Zone",
      "type": "timeseries",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 8
      },
      "datasource": {
        "type": "postgres",
        "uid": "PostgreSQL"
      },
      "targets": [
        {
          "rawSql": "SELECT ts.ts::timestamp as time, ts.value::float, 'Zone ' || ts.zone_id::text || ' - ' || s.type as metric FROM telemetry_samples ts JOIN sensors s ON s.id = ts.sensor_id WHERE s.type = 'TEMPERATURE' AND ts.ts >= NOW() - INTERVAL '30 days' AND ts.ts <= NOW() ORDER BY ts.ts LIMIT 5000",
          "format": "time_series",
          "refId": "A"
        }
      ]
    },
    {
      "id": 4,
      "title": "Current Zone Values",
      "type": "table",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 8
      },
      "datasource": {
        "type": "postgres",
        "uid": "PostgreSQL"
      },
      "targets": [
        {
          "rawSql": "SELECT zone_id, metric_type, value, updated_at FROM telemetry_last ORDER BY zone_id, metric_type",
          "format": "table",
          "refId": "A"
        }
      ]
    }
  ]
}
