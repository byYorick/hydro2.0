# Добавленные моки для тестов

## Глобальные моки (vitest.setup.ts)

### 1. ✅ Виртуализация компонентов
- **DynamicScroller** - мок для виртуализации с поддержкой slots
- **DynamicScrollerItem** - мок для элемента виртуализации
- **RecycleScroller** - мок для переработки элементов

### 2. ✅ Logger
- Глобальный мок для `@/utils/logger` с методами debug, info, warn, error

## Моки в тестах

### 1. ✅ useSystemStatus.mqtt.spec.ts
- Исправлен доступ к мокам `useApi` через глобальную переменную
- Добавлен тестовый компонент для правильной работы lifecycle hooks

### 2. ✅ ErrorBoundary.spec.ts
- Добавлен мок для `router.reload()` вместо `window.location.reload`
- Исправлен тест для проверки вызова `router.reload({ only: [] })`

### 3. ✅ useTelemetry.spec.ts
- Обновлены тесты для проверки общих сообщений об ошибках вместо конкретных
- Исправлена проверка toast уведомлений

### 4. ✅ useTelemetry.cache.spec.ts
- Исправлен мок `useApi` для правильного возврата `response.data`
- Добавлена поддержка `vi.resetModules()` для перезагрузки кеша

### 5. ✅ Recipes/Edit.spec.ts
- Исправлен мок `useForm` для правильной инициализации `phases` как массива
- Добавлены геттеры для прямого доступа к полям формы

## Результаты

- ✅ Все основные моки добавлены
- ✅ Исправлены проблемы с доступом к мокам
- ✅ Обновлены тесты для соответствия новой логике обработки ошибок
- ✅ Исправлены lifecycle hooks в тестах

## Статус

Все моки добавлены и тесты готовы к запуску в Docker.

