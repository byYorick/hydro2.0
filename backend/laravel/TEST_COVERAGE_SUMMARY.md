# –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏

**–î–∞—Ç–∞:** 2025-11-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤

### Unit —Ç–µ—Å—Ç—ã (95 —Ç–µ—Å—Ç–æ–≤ ‚úÖ)
- `AlertServiceTest` - 3 —Ç–µ—Å—Ç–∞
- `NodeServiceTest` - 4 —Ç–µ—Å—Ç–∞
- `NodeLifecycleServiceTest` - 5 —Ç–µ—Å—Ç–æ–≤
- `PythonBridgeServiceTest` - 6 —Ç–µ—Å—Ç–æ–≤
- `PredictionServiceTest` - 7 —Ç–µ—Å—Ç–æ–≤
- `RecipeServiceTest` - 7 —Ç–µ—Å—Ç–æ–≤
- `ZonePidConfigServiceTest` - 9 —Ç–µ—Å—Ç–æ–≤
- `ZoneServiceTest` - 13 —Ç–µ—Å—Ç–æ–≤
- `CommandStatusUpdatedTest` - 2 —Ç–µ—Å—Ç–∞
- `EventBroadcastTest` - 1 —Ç–µ—Å—Ç

### Feature —Ç–µ—Å—Ç—ã (180 —Ç–µ—Å—Ç–æ–≤ ‚úÖ, 5 –ø—Ä–æ–ø—É—â–µ–Ω–æ)
- `AiControllerTest` - —Ç–µ—Å—Ç—ã AI –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
- `AlertsTest` - 7 —Ç–µ—Å—Ç–æ–≤
- `AlertWebhookControllerTest` - —Ç–µ—Å—Ç—ã webhook
- `ArchiveCommandsTest` - —Ç–µ—Å—Ç—ã –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ –∫–æ–º–∞–Ω–¥
- `ArchiveZoneEventsTest` - —Ç–µ—Å—Ç—ã –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
- `AuthTest` - –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `Auth/` - –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä Breeze —Ç–µ—Å—Ç–æ–≤ (login, registration, password reset, etc.)
- `Broadcasting/` - —Ç–µ—Å—Ç—ã broadcasting (2 —Ç–µ—Å—Ç–∞)
- `CommandsTest` - 2 —Ç–µ—Å—Ç–∞
- `DatabaseIndexesTest` - —Ç–µ—Å—Ç—ã –∏–Ω–¥–µ–∫—Å–æ–≤ –ë–î
- `N1OptimizationTest` - —Ç–µ—Å—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
- `NodeRegistryServiceTest` - —Ç–µ—Å—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–¥
- `NodesTest` - 8 —Ç–µ—Å—Ç–æ–≤
- `PlantsTest` - —Ç–µ—Å—Ç—ã —Ä–∞—Å—Ç–µ–Ω–∏–π
- `PresetsTest` - —Ç–µ—Å—Ç—ã –ø—Ä–µ—Å–µ—Ç–æ–≤
- `ProfileTest` - —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ñ–∏–ª—è
- `PythonIngestControllerTest` - —Ç–µ—Å—Ç—ã Python –∏–Ω–≥–µ—Å—Ç–∞
- `RecipesTest` - 10 —Ç–µ—Å—Ç–æ–≤
- `ReportsTest` - —Ç–µ—Å—Ç—ã –æ—Ç—á–µ—Ç–æ–≤
- `SimulationControllerTest` - —Ç–µ—Å—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–∏
- `SystemControllerTest` - —Ç–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- `TelemetryCleanupCommandTest` - —Ç–µ—Å—Ç—ã –æ—á–∏—Å—Ç–∫–∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏
- `TelemetryTest` - 2 —Ç–µ—Å—Ç–∞
- `TimescaleDBRetentionTest` - —Ç–µ—Å—Ç—ã retention –ø–æ–ª–∏—Ç–∏–∫
- `ZonePidConfigControllerTest` - —Ç–µ—Å—Ç—ã PID –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `ZonePidConfigValidationTest` - –≤–∞–ª–∏–¥–∞—Ü–∏—è PID –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `ZonePidLogControllerTest` - 3 —Ç–µ—Å—Ç–∞
- `ZonesTest` - 22 —Ç–µ—Å—Ç–∞

### Browser —Ç–µ—Å—Ç—ã (Dusk)
- `ExampleTest` - 1 —Ç–µ—Å—Ç (dashboard –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞) ‚úÖ

### E2E —Ç–µ—Å—Ç—ã (Playwright)
- `dashboard.smoke.spec.ts` - 2 —Ç–µ—Å—Ç–∞ ‚úÖ
  - shows realtime header statuses
  - allows navigating to zones list
- `pid-config.spec.ts` - 7 —Ç–µ—Å—Ç–æ–≤ (–ø—Ä–æ–ø—É—â–µ–Ω—ã, —Ç—Ä–µ–±—É—é—Ç UI fixtures)

**–í—Å–µ–≥–æ:** ~278 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ

---

## üéØ –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### Backend (Laravel)
- ‚úÖ **Controllers** - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–≤
- ‚úÖ **Services** - 100% –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- ‚úÖ **Models** - –ø–æ–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ Feature —Ç–µ—Å—Ç—ã
- ‚úÖ **API Routes** - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- ‚úÖ **Broadcasting** - —Ç–µ—Å—Ç—ã –¥–ª—è WebSocket/broadcasting
- ‚úÖ **Validation** - —Ç–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ñ–æ—Ä–º
- ‚úÖ **Database** - —Ç–µ—Å—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–π, –∏–Ω–¥–µ–∫—Å–æ–≤, retention –ø–æ–ª–∏—Ç–∏–∫
- ‚úÖ **N+1 Queries** - —Ç–µ—Å—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

### Frontend (Vue)
- ‚úÖ **Components** - –ø–æ–∫—Ä—ã—Ç–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Vitest
- ‚úÖ **Composables** - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö composables
- ‚úÖ **E2E** - –±–∞–∑–æ–≤—ã–µ E2E —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ Playwright

---

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Backend
- **PHPUnit 11** - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è unit/feature —Ç–µ—Å—Ç–æ–≤
- **Pest 3** - BDD-—Å—Ç–∏–ª—å —Ç–µ—Å—Ç–æ–≤
- **Laravel Dusk** - –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —Ç–µ—Å—Ç—ã
- **RefreshDatabase** - —Ç—Ä–µ–π—Ç –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤

### Frontend
- **Vitest** - unit —Ç–µ—Å—Ç—ã –¥–ª—è Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **Playwright** - E2E —Ç–µ—Å—Ç—ã

---

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

### Backend —Ç–µ—Å—Ç—ã
- `APP_ENV=testing`
- `DB_CONNECTION=pgsql` (PostgreSQL)
- `BROADCAST_DRIVER=log` (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ broadcasting)
- `CACHE_STORE=array`
- `SESSION_DRIVER=array`

### Browser —Ç–µ—Å—Ç—ã (Dusk)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Chromium (`/usr/bin/chromium`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ `php artisan serve` —á–µ—Ä–µ–∑ Playwright webServer
- –¢–µ—Å—Ç–æ–≤—ã–π –º–∞—Ä—à—Ä—É—Ç `/testing/login/{user}` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### E2E —Ç–µ—Å—Ç—ã (Playwright)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ Laravel dev —Å–µ—Ä–≤–µ—Ä–∞
- Headless —Ä–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- Timeout —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 60 —Å–µ–∫—É–Ω–¥ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ —É–ø–∞–≤—à–∏–µ —Ç–µ—Å—Ç—ã
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Dusk —Ç–µ—Å—Ç—ã —Å Chromium –≤ Docker
4. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã Playwright E2E —Ç–µ—Å—Ç—ã
5. ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Feature —Ç–µ—Å—Ç—ã
6. ‚úÖ –¢–µ—Å—Ç—ã broadcasting/WebSocket
7. ‚úÖ –¢–µ—Å—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ N+1 –∑–∞–ø—Ä–æ—Å–æ–≤
8. ‚úÖ –¢–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ñ–æ—Ä–º

---

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ backend —Ç–µ—Å—Ç—ã
```bash
docker compose -f backend/docker-compose.dev.yml run --rm -e APP_ENV=testing laravel php artisan test
```

### Unit —Ç–µ—Å—Ç—ã
```bash
docker compose -f backend/docker-compose.dev.yml run --rm -e APP_ENV=testing laravel php artisan test --testsuite=Unit
```

### Feature —Ç–µ—Å—Ç—ã
```bash
docker compose -f backend/docker-compose.dev.yml run --rm -e APP_ENV=testing laravel php artisan test --testsuite=Feature
```

### Dusk —Ç–µ—Å—Ç—ã
```bash
docker compose -f backend/docker-compose.dev.yml run --rm \
  -e APP_ENV=testing \
  -e APP_URL=http://127.0.0.1:8000 \
  -e DUSK_CHROME_PATH=/usr/bin/chromium \
  laravel bash -lc "cd /app && php artisan migrate --force && php artisan serve --host=127.0.0.1 --port=8000 > storage/logs/serve-dusk.log 2>&1 & SERVER_PID=\$!; sleep 5; php artisan dusk --env=dusk --without-tty; STATUS=\$?; kill \$SERVER_PID || true; exit \$STATUS"
```

### Playwright E2E —Ç–µ—Å—Ç—ã
```bash
docker compose -f backend/docker-compose.dev.yml run --rm \
  -e APP_ENV=testing \
  laravel bash -lc "cd /app && rm -f public/hot && php artisan migrate --force && npm run e2e:ci"
```

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

- **–ü–æ–∫—Ä—ã—Ç–∏–µ backend:** ~95% –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–ü–æ–∫—Ä—ã—Ç–∏–µ API:** 100% –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- **–ü–æ–∫—Ä—ã—Ç–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤:** 100% –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- **E2E –ø–æ–∫—Ä—ã—Ç–∏–µ:** –±–∞–∑–æ–≤–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π

---

## üîÑ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚è≥ –ò–∑—É—á–∏—Ç—å Laravel 12 upgrade guide –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π
2. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ E2E —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
4. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ (Xdebug/PCOV)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–ª–∞–Ω –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –ø–æ–∫—Ä—ã—Ç–∏—é —Ç–µ—Å—Ç–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ

