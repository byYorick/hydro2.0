# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

**–î–∞—Ç–∞:** 2025-01-27  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

## –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚úÖ Python service token verified but service user not found

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–ü–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö Laravel –æ —Ç–æ–º, —á—Ç–æ —Ç–æ–∫–µ–Ω Python —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
1. –ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ `VerifyPythonServiceToken` middleware:
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω, –Ω–æ —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω, –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ —Å WARNING –Ω–∞ INFO (–æ–¥–∏–Ω —Ä–∞–∑) –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–∞—Å–æ—Ä–µ–Ω–∏—è –ª–æ–≥–æ–≤
2. –°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:
   - Email: `python-service@hydro.local`
   - –†–æ–ª—å: `viewer` (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞)
   - ID: 1

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –í –ª–æ–≥–∞—Ö —Ç–µ–ø–µ—Ä—å `Python service token verified successfully, service user set {"user_id":1}`

**–§–∞–π–ª—ã:**
- `backend/laravel/app/Http/Middleware/VerifyPythonServiceToken.php`

### 2. ‚úÖ relation "cache" does not exist

**–ü—Ä–æ–±–ª–µ–º–∞:**  
–û—à–∏–±–∫–∞ –≤ PostgreSQL –æ —Ç–æ–º, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ cache –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ, —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è `0001_01_01_000001_create_cache_table` –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- –¢–∞–±–ª–∏—Ü–∞ `cache` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ –∫–µ—à–∞: `Cache test: OK`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –¢–∞–±–ª–∏—Ü–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –∫–µ—à —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 3. ‚úÖ Prometheus –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Alertmanager

**–ü—Ä–æ–±–ª–µ–º–∞:**  
Prometheus –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫–∏: `dial tcp: lookup alertmanager on 127.0.0.11:53: server misbehaving`

**–ü—Ä–∏—á–∏–Ω–∞:**
- Alertmanager –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω –≤ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
- Prometheus –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Å–µ—Ä–≤–∏—Å

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alertmanager –≤ `prometheus.yml` –¥–ª—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è
- Prometheus –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –û—à–∏–±–∫–∏ Prometheus —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã

**–§–∞–π–ª—ã:**
- `backend/configs/dev/prometheus.yml`

### 4. ‚ö†Ô∏è Alertmanager –∏ Grafana –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã

**–°—Ç–∞—Ç—É—Å:** –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ

**–ü—Ä–∏—á–∏–Ω–∞:**
- –≠—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –¥–ª—è dev –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤ production

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
  ```bash
  docker-compose -f docker-compose.dev.yml up -d alertmanager grafana
  ```
- –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Alertmanager –≤ `prometheus.yml`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### ‚úÖ –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
- Laravel: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω, –∫–µ—à —Ä–∞–±–æ—Ç–∞–µ—Ç
- PostgreSQL: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, —Ç–∞–±–ª–∏—Ü–∞ cache —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- Prometheus: ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç, –æ—à–∏–±–∫–∏ Alertmanager —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- Python —Å–µ—Ä–≤–∏—Å—ã: ‚úÖ –†–∞–±–æ—Ç–∞—é—Ç, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞

### ‚úÖ –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç:
- ConfigSignatureServiceTest: ‚úÖ 5 passed
- ConfigPublishLockServiceTest: ‚úÖ 6 passed

## –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

‚úÖ **–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**
- Python —Å–µ—Ä–≤–∏—Å—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ö–µ—à —Ä–∞–±–æ—Ç–∞–µ—Ç
- Prometheus –Ω–µ –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–æ–∫
- –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç

‚ö†Ô∏è **–ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- Alertmanager –∏ Grafana –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã)

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. ‚úÖ –°–æ–∑–¥–∞–Ω —Å–µ—Ä–≤–∏—Å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è Python —Å–µ—Ä–≤–∏—Å–æ–≤
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∫–µ—à–∞
3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Prometheus
4. ‚ö†Ô∏è –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ - –∑–∞–ø—É—Å—Ç–∏—Ç—å Alertmanager –∏ Grafana

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ! üöÄ

