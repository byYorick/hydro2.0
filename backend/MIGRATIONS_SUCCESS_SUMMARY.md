# –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π

–î–∞—Ç–∞: 2025-12-25

## ‚úÖ –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ

### –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (15 —à—Ç.)

**PHASE 1:**
- ‚úÖ `2025_12_25_151710_modify_grow_cycles_table` - Ran
- ‚úÖ `2025_12_25_151713_add_constraints_to_grow_cycles` - Ran
- ‚úÖ `2025_12_25_151714_drop_legacy_tables` - Ran

**PHASE 2:**
- ‚úÖ `2025_12_25_151715_create_grow_cycle_phases_table` - Ran
- ‚úÖ `2025_12_25_151716_create_grow_cycle_phase_steps_table` - Ran
- ‚úÖ `2025_12_25_151717_update_grow_cycles_for_snapshots` - Ran

**PHASE 3:**
- ‚úÖ `2025_12_25_151718_create_sensors_table` - Ran
- ‚úÖ `2025_12_25_151719_create_telemetry_samples_table` - Ran
- ‚úÖ `2025_12_25_151720_create_telemetry_last_table` - Ran

**PHASE 4:**
- ‚úÖ `2025_12_25_151721_update_commands_for_two_phase_confirmation` - Ran
- ‚úÖ `2025_12_25_151722_create_command_acks_table` - Ran

**PHASE 5:**
- ‚úÖ `2025_12_25_151723_add_final_constraints_and_indexes` - Ran

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î

### –¢–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:
- ‚úÖ `grow_cycle_phases` - —Å–Ω–∞–ø—à–æ—Ç—ã —Ñ–∞–∑ —Ü–∏–∫–ª–æ–≤
- ‚úÖ `grow_cycle_phase_steps` - —Å–Ω–∞–ø—à–æ—Ç—ã —à–∞–≥–æ–≤ —Ñ–∞–∑
- ‚úÖ `sensors` - –µ–¥–∏–Ω–∞—è –º–æ–¥–µ–ª—å —Å–µ–Ω—Å–æ—Ä–æ–≤
- ‚úÖ `telemetry_samples` - —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è (–Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- ‚úÖ `telemetry_last` - –∫—ç—à –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- ‚úÖ `command_acks` - –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥

### FK constraints –≤ grow_cycles:
- ‚úÖ `current_phase_id` ‚Üí `grow_cycle_phases.id` (—Å–Ω–∞–ø—à–æ—Ç)
- ‚úÖ `current_step_id` ‚Üí `grow_cycle_phase_steps.id` (—Å–Ω–∞–ø—à–æ—Ç)
- ‚úÖ `recipe_revision_id` ‚Üí `recipe_revisions.id` (NOT NULL)

### –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã:
- ‚úÖ `grow_cycles_zone_active_unique` - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
- ‚úÖ `nodes_zone_unique` - –ø—Ä–∞–≤–∏–ª–æ 1 –∑–æ–Ω–∞ = 1 –Ω–æ–¥–∞
- ‚úÖ `node_channels_node_id_channel_unique` - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–∞–Ω–∞–ª–æ–≤ –Ω–æ–¥—ã
- ‚úÖ `recipe_revisions_recipe_revision_unique` - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π —Ä–µ—Ü–µ–ø—Ç–∞
- ‚úÖ `recipe_revision_phases_revision_phase_unique` - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–∑
- ‚úÖ `recipe_revision_phase_steps_phase_step_unique` - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤
- ‚úÖ `grow_cycle_phases_cycle_phase_unique` - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–∑ –≤ —Ü–∏–∫–ª–µ
- ‚úÖ `grow_cycle_phase_steps_phase_step_unique` - —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤ –≤ —Ñ–∞–∑–µ

### Legacy —Ç–∞–±–ª–∏—Ü—ã —É–¥–∞–ª–µ–Ω—ã:
- ‚úÖ `zone_recipe_instances` - —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ `recipe_phases` - —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ `zone_cycles` - —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ `plant_cycles` - —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ `commands_archive` - —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ `zone_events_archive` - —É–¥–∞–ª–µ–Ω–∞

### –ù–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ commands:
- ‚úÖ `cycle_id` - —Å–≤—è–∑—å —Å —Ü–∏–∫–ª–æ–º (nullable)
- ‚úÖ `context_type` - —Ç–∏–ø –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (cycle|manual|maintenance|calibration)
- ‚úÖ `request_id` - –¥–ª—è –¥–≤—É—Ö—Ñ–∞–∑–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (unique)
- ‚úÖ `command_type` - –∞–ª–∏–∞—Å –¥–ª—è cmd
- ‚úÖ `payload` - –∞–ª–∏–∞—Å –¥–ª—è params

## üìä –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

**–í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ PHASE 0-5 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ.**

**–°—Ö–µ–º–∞ –ë–î –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–≤–æ–π –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:**
- ‚úÖ GrowCycle –∫–∞–∫ —Ü–µ–Ω—Ç—Ä –∏—Å—Ç–∏–Ω—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –°–Ω–∞–ø—à–æ—Ç—ã —Ñ–∞–∑ –∏ —à–∞–≥–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ï–¥–∏–Ω–∞—è –º–æ–¥–µ–ª—å —Å–µ–Ω—Å–æ—Ä–æ–≤ –≤–Ω–µ–¥—Ä–µ–Ω–∞
- ‚úÖ –î–≤—É—Ö—Ñ–∞–∑–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- ‚úÖ –í—Å–µ constraints –∏ –∏–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚úÖ Legacy —Ç–∞–±–ª–∏—Ü—ã —É–¥–∞–ª–µ–Ω—ã

**–ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ –≠—Ç–∞–ø 2 (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ —Å–µ—Ä–≤–∏—Å–æ–≤).**

