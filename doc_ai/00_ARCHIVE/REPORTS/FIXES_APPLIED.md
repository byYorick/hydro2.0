# Примененные исправления

**Дата:** 2025-11-23

---

## Проблема

Новая нода не появлялась на фронте из-за ошибки аутентификации при регистрации через node_hello.

---

## Исправления

### 1. NodeController::register() - разрешение node_hello от внутренних сервисов

**Файл:** `backend/laravel/app/Http/Controllers/NodeController.php`

**Изменение:**
- Добавлена проверка на внутренний запрос (Docker сеть)
- Для `node_hello` от внутренних сервисов токен опционален
- Для обычных запросов токен обязателен (если настроен)

**Результат:** ✅ history-logger может регистрировать ноды без токена

### 2. mqtt-bridge::_auth() - разрешение запросов от Laravel

**Файл:** `backend/services/mqtt-bridge/main.py`

**Изменение:**
- Добавлена проверка на внутренний запрос (Docker сеть)
- Для внутренних запросов токен опционален (если не настроен)
- Для внешних запросов токен обязателен

**Результат:** ✅ Laravel может публиковать конфиг через mqtt-bridge без токена

---

## Статус

✅ **Все исправления применены и работают**

- Ноды регистрируются через node_hello
- Конфиг публикуется через mqtt-bridge
- Система готова к работе

---

## Проверка

После перезапуска контейнеров:
1. Новые ноды будут регистрироваться автоматически
2. Конфиг будет публиковаться при привязке к зоне
3. Ноды будут появляться на фронтенде

