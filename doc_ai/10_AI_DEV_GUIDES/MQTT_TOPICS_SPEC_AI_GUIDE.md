# MQTT_TOPICS_SPEC_AI_GUIDE.md
# Инструкция для ИИ-агентов по спецификации MQTT-топиков

Документ объясняет, как ИИ-агенты должны обращаться с MQTT-namespace
и где можно, а где нельзя его изменять.


Compatible-With: Protocol 2.0, Backend >=3.0, Python >=3.0, Database >=3.0, Frontend >=3.0.
Breaking-change: legacy форматы/алиасы удалены, обратная совместимость не поддерживается.

---

## 1. Базовый формат

Базовый формат описан в `../03_TRANSPORT_MQTT/MQTT_NAMESPACE.md`:

```text
hydro/{gh}/{zone}/{node}/{channel}/{message_type}
```

Изменять его **нельзя** без очень серьёзной причины и рефакторинга всей системы.

---

## 2. Допустимые расширения

ИИ-агент может:

- вводить **новые значения** для `{message_type}`, например `config` или `diag`,
 но только если они:

 - описаны в `../03_TRANSPORT_MQTT/MQTT_NAMESPACE.md`;
 - поддержаны в Python-сервисе;
 - не ломают существующие обработчики.

- вводить новые каналы (`{channel}`), **если** они:

 - добавлены в `../02_HARDWARE_FIRMWARE/NODE_CHANNELS_REFERENCE.md`;
 - отражены в `../05_DATA_AND_STORAGE/DATA_MODEL_REFERENCE.md` (таблица `channels`).

---

## 3. Чего делать нельзя

- Менять порядок сегментов топика.
- Смешивать системные и зональные топики (например, писать телеметрию в `hydro/system/ `).
- Использовать MQTT как произвольный «лог-хранилище» больших JSON-структур.

---

## 4. Взаимодействие с Python-сервисом

Любое изменение топиков должно сопровождаться изменениями в:

- парсере топиков Python-сервиса;
- маршрутизации сообщений;
- документации (`PYTHON_MQTT_SERVICE_AI_GUIDE.md`).

---

## 5. Резюме

MQTT-namespace — это контракт между всеми компонентами системы. 
ИИ-агенты должны относиться к нему как к **API уровня протокола**, а не просто строкам.
