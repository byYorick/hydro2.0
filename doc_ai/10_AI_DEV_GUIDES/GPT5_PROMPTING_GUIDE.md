# GPT-5.1 Codex Max Prompting Guide

Краткий конспект рекомендаций из OpenAI Cookbook для эффективной работы с GPT-5.1 Codex Max, адаптированный под наш проект.

## Принципы эффективных промптов
- **Чётко формулируйте задачу.** Описывайте цель, ограничения и критерии успешного результата (форматы, поля, тон ответа).
- **Давайте контекст.** Передавайте доменную информацию, соглашения по коду и примеры, которые нужно переиспользовать.
- **Используйте директивы.** Пишите императивно ("Верни JSON с такими ключами", "Не изменяй миграции") вместо расплывчатых просьб.
- **Ограничивайте вывод.** Указывайте схемы, разделители, кодовые блоки и нужно ли скрывать рассуждения.
- **Показывайте примеры.** Добавляйте 1–2 реалистичных примера ввода/вывода, включая крайние случаи, чтобы задать стиль.
- **Убирайте двусмысленности.** Явно перечисляйте запрещённые действия и предпочтительные компромиссы.
- **Итеративно уточняйте.** Начинайте с краткого брифа и добавляйте точечные уточнения (тесты, ошибки, производительность) вместо переписывания с нуля.

## Подсказки для работы с инструментами и кодогенерацией
- Описывайте доступные инструменты/команды: параметры, обязательные проверки, что возвращать после вызовов.
- При генерации кода просите указать файлы, сигнатуры функций и предположения (env vars, сервисы, порты), чтобы снизить число уточнений.
- Если не удаётся создать ветку или PR, явно указывайте текст ошибки инструмента и предлагайте план обхода (ручное создание ветки, проверка прав).
- Запрашивайте тесты и кейсы валидации заранее; отдавайте предпочтение идемпотентным операциям и инструкциям по откату.
- Для длинных ответов задавайте структуру (Summary, Changes, Tests) и просите опускать шумные логи.

### Что делать при ошибках создания ветки/PR
- В ответе процитируйте дословно сообщение об ошибке инструмента (без интерпретаций) и укажите, на каком шаге оно возникло.
- Проверьте права: есть ли доступ на push/создание веток, не включена ли защита ветки по умолчанию.
- Предложите обходной путь: ручное создание ветки, явное указание origin/upstream, повторная попытка с правильным названием ветки.
- Если ничего не помогает, зафиксируйте: версию инструмента (если видно), команду/параметры, время и контекст задачи, чтобы проще было воспроизвести баг.

## Контроль качества
- Поощряйте самопроверки: "Сначала перечисли риски", "Сверь типы со схемой", "Пройди по критериям приёмки".
- Требуйте обработки крайних случаев, ошибок и границ авторизации.
- Просите отмечать недостающие входные данные вместо выдумывания значений.
- Добавляйте само-проверку: "Проверь соответствие схемe и сообщи о расхождениях".

## Шаблон промпта
Используйте этот каркас и адаптируйте под задачу:

```
You are GPT-5.1 Codex Max helping with <project/module>.
Goal: <что нужно сделать>.
Context: <доменные правила, файлы, API, зависимости>.
Constraints: <запрещённые действия, требования по производительности/UX/безопасности>.
Output: <формат, файлы, секции, схемы>.
Examples: <при необходимости — примеры ввода/вывода или тон>.
Checks: <тесты, валидации, риски>.
```

## Источник
- OpenAI Cookbook — GPT-5.1 Codex Max prompting guide: https://cookbook.openai.com/examples/gpt-5/gpt-5-1-codex-max_prompting_guide
