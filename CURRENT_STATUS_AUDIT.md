# –ê—É–¥–∏—Ç —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–î–∞—Ç–∞: 2025-01-27  
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∞—É–¥–∏—Ç–∞

---

## üéâ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å!

### ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞—É–¥–∏—Ç–∞

#### 1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `mqtt_client` ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù
- **–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `firmware/nodes/common/components/mqtt_client/`
- **–°—Ç–∞—Ç—É—Å:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤–æ –≤—Å–µ –Ω–æ–¥—ã
- **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
  - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MQTT –±—Ä–æ–∫–µ—Ä—É
  - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ config –∏ command —Ç–æ–ø–∏–∫–∏
  - –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏, —Å—Ç–∞—Ç—É—Å–æ–≤, heartbeat, command_response
  - Callbacks –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
  - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ README.md

#### 2. –í—Å–µ –Ω–æ–¥—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã —Å mqtt_client ‚úÖ
- **ph_node** ‚Äî 286 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞ config/command, –ø—Ä–∏–º–µ—Ä—ã —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏
- **ec_node** ‚Äî 280 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **climate_node** ‚Äî 365 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤
- **pump_node** ‚Äî 343 —Å—Ç—Ä–æ–∫–∏ –∫–æ–¥–∞, –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è mqtt_client

#### 3. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ ‚úÖ
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ `firmware/nodes/common/components/`
- –í—Å–µ –Ω–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `mqtt_client`
- –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Å–µ—Ö –Ω–æ–¥

---

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### Firmware –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------|------------|-------------|
| **mqtt_client** | ‚úÖ MVP_DONE | 90% | –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö –Ω–æ–¥–∞—Ö |
| **config_storage** | ‚ùå PLANNED | 0% | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω—É–∂–µ–Ω –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ NodeConfig –∏–∑ NVS |
| **i2c_bus** | ‚ùå PLANNED | 0% | –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω—É–∂–µ–Ω –¥–ª—è INA209 –∏ —Å–µ–Ω—Å–æ—Ä–æ–≤ |
| **logging** | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | 50% | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ESP_LOG, –Ω–æ –Ω–µ—Ç –µ–¥–∏–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ |

### Firmware –Ω–æ–¥—ã

| –ù–æ–¥–∞ | –°—Ç–∞—Ç—É—Å | –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å | –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ | –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å |
|------|--------|------------|-------------|--------------|
| **ph_node** | ‚ö†Ô∏è IN_PROGRESS | 40% | MQTT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ | –î—Ä–∞–π–≤–µ—Ä pH, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞, —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è |
| **ec_node** | ‚ö†Ô∏è IN_PROGRESS | 40% | MQTT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ | –î—Ä–∞–π–≤–µ—Ä EC, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞, —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è |
| **climate_node** | ‚ö†Ô∏è IN_PROGRESS | 40% | MQTT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ | –î—Ä–∞–π–≤–µ—Ä—ã SHT3x/CCS811, —Ä–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è |
| **pump_node** | ‚ö†Ô∏è IN_PROGRESS | 30% | MQTT –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ | INA209 –¥—Ä–∞–π–≤–µ—Ä, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ —Ç–æ–∫—É |

---

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ

1. **MQTT –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è:**
   - –í—Å–µ –Ω–æ–¥—ã –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ MQTT
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ config –∏ command —Å–æ–æ–±—â–µ–Ω–∏–π
   - –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ (–ø—Ä–∏–º–µ—Ä—ã)
   - –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞:**
   - –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤—Å–µ—Ö –Ω–æ–¥
   - –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ callbacks
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

3. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - README –¥–ª—è mqtt_client
   - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ
   - –°—Å—ã–ª–∫–∏ –Ω–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚ùå

1. **–†–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è:**
   - –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ ‚Äî –∑–∞–≥–ª—É—à–∫–∏ (TODO)
   - –ù–µ—Ç –¥—Ä–∞–π–≤–µ—Ä–æ–≤ —Å–µ–Ω—Å–æ—Ä–æ–≤
   - –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º:**
   - –ö–æ–º–∞–Ω–¥—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è, –Ω–æ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è (TODO)
   - –ù–µ—Ç GPIO —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - –ù–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞—Å–æ—Å–æ–≤/—Ä–µ–ª–µ

3. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
   - Config –ø–∞—Ä—Å–∏—Ç—Å—è, –Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è (TODO)
   - –ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ NVS
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ö–∞—Ä–¥–∫–æ–¥—è—Ç—Å—è

4. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
   - `config_storage` ‚Äî –Ω–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ NVS
   - `i2c_bus` ‚Äî –Ω–µ—Ç —Ä–∞–±–æ—Ç—ã —Å I¬≤C —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
   - –î—Ä–∞–π–≤–µ—Ä—ã —Å–µ–Ω—Å–æ—Ä–æ–≤ ‚Äî –Ω–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ TODO –≤ –∫–æ–¥–µ

### ph_node (4 TODO)
1. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 80)
2. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å–æ—Å–æ–º (—Å—Ç—Ä–æ–∫–∞ 136)
3. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (—Å—Ç—Ä–æ–∫–∞ 161)
4. –†–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –¥–∞—Ç—á–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 273-274)

### ec_node (4 TODO)
1. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 79)
2. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å–æ—Å–æ–º (—Å—Ç—Ä–æ–∫–∞ 132)
3. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (—Å—Ç—Ä–æ–∫–∞ 157)
4. –†–µ–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –¥–∞—Ç—á–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 267-268)

### climate_node (7 TODO)
1. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 81)
2. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–ª–µ (—Å—Ç—Ä–æ–∫–∞ 134)
3. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PWM (—Å—Ç—Ä–æ–∫–∞ 157)
4. –†–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å SHT3x/CCS811 (—Å—Ç—Ä–æ–∫–∏ 267-268, 294-295, 321-322)

### pump_node (3 TODO)
1. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 92)
2. –†–µ–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å–æ—Å–æ–º (—Å—Ç—Ä–æ–∫–∞ 146)
3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ RSSI (—Å—Ç—Ä–æ–∫–∞ 332)

---

## üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `config_storage` (–ö—Ä–∏—Ç–∏—á–Ω–æ)

**–ü–æ—á–µ–º—É:**
- –í—Å–µ –Ω–æ–¥—ã —Ö–∞—Ä–¥–∫–æ–¥—è—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã MQTT
- –ù–µ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ NodeConfig –∏–∑ NVS
- –ë–µ–∑ —ç—Ç–æ–≥–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ó–∞–≥—Ä—É–∑–∫–∞ NodeConfig –∏–∑ NVS –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞
- API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –∫–æ–Ω—Ñ–∏–≥–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2-3 –¥–Ω—è

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `firmware/NODE_CONFIG_SPEC.md`
- `doc_ai/02_HARDWARE_FIRMWARE/NODE_ARCH_FULL.md`

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `i2c_bus` (–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Å–µ–Ω—Å–æ—Ä–æ–≤)

**–ü–æ—á–µ–º—É:**
- –ù—É–∂–µ–Ω –¥–ª—è INA209 (pump_node)
- –ù—É–∂–µ–Ω –¥–ª—è SHT3x (climate_node)
- –ù—É–∂–µ–Ω –¥–ª—è pH/EC —Å–µ–Ω—Å–æ—Ä–æ–≤ (–µ—Å–ª–∏ –æ–Ω–∏ I¬≤C)

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ë–∞–∑–æ–≤—ã–π I¬≤C –¥—Ä–∞–π–≤–µ—Ä —Å mutex
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- API –¥–ª—è —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2-3 –¥–Ω—è

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `doc_ai/02_HARDWARE_FIRMWARE/ESP32_C_CODING_STANDARDS.md`

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –î—Ä–∞–π–≤–µ—Ä INA209 –¥–ª—è pump_node (–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è MVP)

**–ü–æ—á–µ–º—É:**
- –ë–µ–∑ –Ω–µ–≥–æ pump_node –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥
- –≠—Ç–æ –∫–ª—é—á–µ–≤–∞—è —Ñ–∏—á–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è INA209 —á–µ—Ä–µ–∑ I¬≤C
- –ß—Ç–µ–Ω–∏–µ —Ç–æ–∫–∞ (shunt voltage ‚Üí current)
- –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 3-4 –¥–Ω—è

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- `doc_ai/02_HARDWARE_FIRMWARE/TASK_INA209_PUMP_NODE.md`

---

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞—Å–æ—Å–∞–º–∏ –≤ pump_node

**–ü–æ—á–µ–º—É:**
- –ë–µ–∑ —ç—Ç–æ–≥–æ pump_node –Ω–µ –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã
- –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–æ–¥—ã

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- GPIO –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è MOSFET/–æ–ø—Ç–æ–ø–∞—Ä–æ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ `run_pump`
- –¢–∞–π–º–µ—Ä—ã –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å INA209 –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

**–û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏:** 2-3 –¥–Ω—è

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π

### –ù–µ–¥–µ–ª—è 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
1. **–î–µ–Ω—å 1-3:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `config_storage`
   - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ NVS
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞
   - API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞

2. **–î–µ–Ω—å 4-6:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `i2c_bus`
   - –ë–∞–∑–æ–≤—ã–π –¥—Ä–∞–π–≤–µ—Ä
   - Mutex –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ù–µ–¥–µ–ª—è 2: pump_node –¥–æ—Ä–∞–±–æ—Ç–∫–∞
3. **–î–µ–Ω—å 7-10:** –î—Ä–∞–π–≤–µ—Ä INA209
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
   - –ß—Ç–µ–Ω–∏–µ —Ç–æ–∫–∞
   - –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞

4. **–î–µ–Ω—å 11-13:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏
   - GPIO —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å INA209
   - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥

### –ù–µ–¥–µ–ª—è 3: –°–µ–Ω—Å–æ—Ä–Ω—ã–µ –Ω–æ–¥—ã
5. **–î–µ–Ω—å 14-16:** –î—Ä–∞–π–≤–µ—Ä—ã —Å–µ–Ω—Å–æ—Ä–æ–≤
   - pH –¥—Ä–∞–π–≤–µ—Ä (ph_node)
   - EC –¥—Ä–∞–π–≤–µ—Ä (ec_node)
   - SHT3x –¥—Ä–∞–π–≤–µ—Ä (climate_node)

6. **–î–µ–Ω—å 17-21:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –†–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è
   - –ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–µ–Ω–¥–µ

---

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å MVP

### –¢–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å: ~45% (–±—ã–ª–æ 5%)

**–†–∞–∑–±–∏–≤–∫–∞:**
- MQTT –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è: ‚úÖ 90%
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–¥: ‚úÖ 80%
- –†–µ–∞–ª—å–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è: ‚ùå 0%
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º: ‚ùå 0%
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: ‚ùå 10%

**–ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ MVP:**
1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç config_storage (2-3 –¥–Ω—è)
2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç i2c_bus (2-3 –¥–Ω—è)
3. –î—Ä–∞–π–≤–µ—Ä INA209 (3-4 –¥–Ω—è)
4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Å–æ—Å–∞–º–∏ (2-3 –¥–Ω—è)
5. –î—Ä–∞–π–≤–µ—Ä—ã —Å–µ–Ω—Å–æ—Ä–æ–≤ (5-7 –¥–Ω–µ–π)
6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (3-5 –¥–Ω–µ–π)

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞:** 3-4 –Ω–µ–¥–µ–ª–∏ –¥–æ —Ä–∞–±–æ—á–µ–≥–æ MVP

---

## üéØ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥

### –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `config_storage`

**–ó–∞–¥–∞—á–∞:**
```
–°–æ–∑–¥–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç config_storage –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è NodeConfig –∏–∑ NVS

–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ: firmware/nodes/common/components/config_storage/

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
‚îú‚îÄ‚îÄ include/
‚îÇ   ‚îî‚îÄ‚îÄ config_storage.h
‚îú‚îÄ‚îÄ config_storage.c
‚îî‚îÄ‚îÄ CMakeLists.txt

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –ó–∞–≥—Ä—É–∑–∫–∞ NodeConfig –∏–∑ NVS –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥–∞ –≤ NVS
3. API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º:
   - node_id, type, version
   - mqtt (host, port, keepalive, user, pass, tls)
   - channels (–º–∞—Å—Å–∏–≤ –∫–∞–Ω–∞–ª–æ–≤)
   - limits, calibration
4. –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞, –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
- firmware/NODE_CONFIG_SPEC.md
- doc_ai/02_HARDWARE_FIRMWARE/NODE_ARCH_FULL.md

–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –∏–∑ NVS
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥ –≤ NVS
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ph_node –≤–º–µ—Å—Ç–æ —Ö–∞—Ä–¥–∫–æ–¥–∞
```

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- –ü—Ä–µ–¥—ã–¥—É—â–∏–π –∞—É–¥–∏—Ç: `NEXT_STEPS_AUDIT.md`
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: `DEVELOPMENT_PRIORITIES.md`
- Roadmap: `doc_ai/ROADMAP_2.0.md`
- –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: `doc_ai/IMPLEMENTATION_STATUS.md`

---

## ‚úÖ –í—ã–≤–æ–¥—ã

1. **–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å:** MQTT –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –≤—Å–µ –Ω–æ–¥—ã —Å–æ–∑–¥–∞–Ω—ã
2. **–û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º
3. **–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `config_storage` –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
4. **–û—Ü–µ–Ω–∫–∞ –¥–æ MVP:** 3-4 –Ω–µ–¥–µ–ª–∏ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö

