# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≠—Ç–∞–ø–∞ 5 - –û—á–∏—Å—Ç–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è

–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: 2025-12-25

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

### 1. –£–¥–∞–ª–µ–Ω—ã –∞—Ä—Ö–∏–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –∫–æ–¥
- ‚úÖ –ö–æ–º–∞–Ω–¥—ã –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã:
  - `ArchiveOldCommands.php` - —É–¥–∞–ª–µ–Ω
  - `ArchiveOldZoneEvents.php` - —É–¥–∞–ª–µ–Ω
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∞—Ä—Ö–∏–≤–æ–≤ —É–¥–∞–ª–µ–Ω—ã:
  - `CommandsArchive.php` - —É–¥–∞–ª–µ–Ω
  - `ZoneEventsArchive.php` - —É–¥–∞–ª–µ–Ω
- ‚úÖ Scheduled –∫–æ–º–∞–Ω–¥—ã —É–¥–∞–ª–µ–Ω—ã –∏–∑ `routes/console.php`
- ‚úÖ –¢–µ—Å—Ç—ã —É–¥–∞–ª–µ–Ω—ã:
  - `ArchiveCommandsTest.php` - —É–¥–∞–ª–µ–Ω
  - `ArchiveZoneEventsTest.php` - —É–¥–∞–ª–µ–Ω
- ‚úÖ `ExtendedArchivesSeeder` –æ–±–Ω–æ–≤–ª–µ–Ω - –º–µ—Ç–æ–¥—ã –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ deprecated

### 2. –ú–∏–≥—Ä–∞—Ü–∏–∏
- ‚úÖ `drop_legacy_tables.php` —É–¥–∞–ª—è–µ—Ç `commands_archive` –∏ `zone_events_archive`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `add_partitioning_and_retention_for_commands_and_zone_events.php`
  - –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è `commands` (–µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏)
  - –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è `zone_events` (–µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –ø–∞—Ä—Ç–∏—Ü–∏–∏)
  - Retention policies (365 –¥–Ω–µ–π)
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ TimescaleDB –∏ native PostgreSQL

### 3. Retention Policies
- ‚úÖ `telemetry_samples` - 90 –¥–Ω–µ–π (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
- ‚úÖ `telemetry_agg_1m` - 30 –¥–Ω–µ–π (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
- ‚úÖ `telemetry_agg_1h` - 365 –¥–Ω–µ–π (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
- ‚úÖ `commands` - 365 –¥–Ω–µ–π (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏)
- ‚úÖ `zone_events` - 365 –¥–Ω–µ–π (–Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –≤ –Ω–æ–≤–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏)

## ‚ö†Ô∏è –û—Å—Ç–∞–≤—à–∏–µ—Å—è —É–ø–æ–º–∏–Ω–∞–Ω–∏—è (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)

### –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–Ω–µ —É–¥–∞–ª—è–µ–º)
- `2025_11_18_000003_create_commands_archive_table.php` - –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
- `2025_11_18_000004_create_zone_events_archive_table.php` - –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
- `2025_12_15_190000_add_details_generated_column_to_zone_events.php` - —É–ø–æ–º–∏–Ω–∞–µ—Ç –∞—Ä—Ö–∏–≤–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –≤ –º–∏–≥—Ä–∞—Ü–∏–∏

### –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ
- `command_tracker.py` - —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ `commands_archive` (deprecated –º–µ—Ç–æ–¥)
- `ExtendedArchivesSeeder.php` - –º–µ—Ç–æ–¥—ã –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ deprecated

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –õ–∏–Ω—Ç–µ—Ä
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

### –£–¥–∞–ª–µ–Ω–æ —Ñ–∞–π–ª–æ–≤
- –ö–æ–º–∞–Ω–¥—ã: 2
- –ú–æ–¥–µ–ª–∏: 2
- –¢–µ—Å—Ç—ã: 2
- –ò—Ç–æ–≥–æ: 6 —Ñ–∞–π–ª–æ–≤

### –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤
- –ú–∏–≥—Ä–∞—Ü–∏–∏: 1
- –ò—Ç–æ–≥–æ: 1 —Ñ–∞–π–ª

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏** - –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (—ç—Ç–æ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** - –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∂–µ, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É retention policies
3. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü

