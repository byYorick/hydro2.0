{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Command Message Schema",
  "description": "Schema for command messages sent to firmware nodes",
  "type": "object",
  "required": ["cmd_id", "cmd", "params", "ts", "sig"],
  "properties": {
    "cmd_id": {
      "type": "string",
      "description": "Unique command identifier"
    },
    "cmd": {
      "type": "string",
      "description": "Command name",
      "enum": [
        "dose",
        "run_pump",
        "set_relay",
        "set_pwm"
      ]
    },
    "params": {
      "type": "object",
      "description": "Command parameters",
      "additionalProperties": true
    },
    "ts": {
      "type": "integer",
      "description": "Unix timestamp (seconds) when command was created",
      "minimum": 0
    },
    "sig": {
      "type": "string",
      "description": "HMAC signature for command payload (hex)"
    }
  },
  "additionalProperties": false
}
