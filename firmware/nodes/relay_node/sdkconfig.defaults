# Конфигурация для relay_node

# WiFi - агрессивная оптимизация памяти
CONFIG_ESP32_WIFI_STATIC_RX_BUFFER_NUM=5
CONFIG_ESP32_WIFI_DYNAMIC_RX_BUFFER_NUM=16
CONFIG_ESP32_WIFI_TX_BUFFER=8
CONFIG_ESP32_WIFI_RX_BA_WIN=8
CONFIG_ESP32_WIFI_DYNAMIC_TX_BUFFER_NUM=16

# MQTT
CONFIG_MQTT_PROTOCOL_311=y

# Logging
CONFIG_LOG_DEFAULT_LEVEL_INFO=y
CONFIG_LOG_MAXIMUM_LEVEL_VERBOSE=y

# FreeRTOS
CONFIG_FREERTOS_HZ=1000

# Partition Table
CONFIG_PARTITION_TABLE_CUSTOM=y
CONFIG_PARTITION_TABLE_CUSTOM_FILENAME="partitions.csv"

# Оптимизация памяти для уменьшения использования DRAM
CONFIG_ESP32_DEFAULT_CPU_FREQ_240=y
CONFIG_ESP32_DEFAULT_CPU_FREQ_MHZ=240
CONFIG_SPIRAM_SUPPORT=n
CONFIG_ESP32S2_SPIRAM_SUPPORT=n
CONFIG_ESP32S3_SPIRAM_SUPPORT=n
CONFIG_ESP32C3_SPIRAM_SUPPORT=n
CONFIG_ESP32H2_SPIRAM_SUPPORT=n

# Оптимизация heap
CONFIG_HEAP_POISONING_COMPREHENSIVE=n
CONFIG_HEAP_POISONING_LIGHT=n
CONFIG_HEAP_POISONING_DISABLED=y
CONFIG_HEAP_TRACING_OFF=y

# Оптимизация логов
CONFIG_LOG_MAXIMUM_EQUALS_DEFAULT=y

# Оптимизация компонентов
CONFIG_ESP_ERR_TO_NAME_LOOKUP=n
CONFIG_ESP_SYSTEM_EVENT_TASK_STACK_SIZE=1536
CONFIG_MAIN_TASK_STACK_SIZE=3072

# Оптимизация компилятора для уменьшения размера
CONFIG_COMPILER_OPTIMIZATION_SIZE=y
CONFIG_COMPILER_OPTIMIZATION_PERF=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_ENABLE=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_SILENT=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_DEBUG=n
CONFIG_COMPILER_OPTIMIZATION_LEVEL_DEBUG=n
CONFIG_COMPILER_OPTIMIZATION_LEVEL_RELEASE=y
CONFIG_COMPILER_OPTIMIZATION_NONE=n
CONFIG_COMPILER_OPTIMIZATION_PERF_DEBUG=n
CONFIG_COMPILER_OPTIMIZATION_PERF_RELEASE=n
CONFIG_COMPILER_OPTIMIZATION_SIZE_DEBUG=n
CONFIG_COMPILER_OPTIMIZATION_SIZE_RELEASE=y
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL=0
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_0=y
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_1=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_2=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_3=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_4=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_5=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_6=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_7=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_8=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_9=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_10=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_11=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_12=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_13=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_14=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_15=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_16=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_17=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_18=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_19=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_20=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_21=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_22=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_23=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_24=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_25=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_26=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_27=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_28=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_29=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_30=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_31=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_32=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_33=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_34=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_35=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_36=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_37=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_38=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_39=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_40=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_41=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_42=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_43=n
CONFIG_COMPILER_OPTIMIZATION_ASSERTIONS_LEVEL_44=n

# Дополнительные оптимизации памяти
CONFIG_ESP32_WIFI_AMPDU_TX_ENABLED=n
CONFIG_ESP32_WIFI_AMPDU_RX_ENABLED=n
CONFIG_ESP32_WIFI_AMSDU_TX_ENABLED=n
CONFIG_ESP32_WIFI_NVS_ENABLED=y
CONFIG_ESP32_WIFI_TX_BUFFER_TYPE=1

# Оптимизация MQTT
CONFIG_MQTT_OUTBOX_EXPIRED_TIMEOUT_MS=30000

# Оптимизация TLS/SSL
CONFIG_MBEDTLS_CERTIFICATE_BUNDLE=n
CONFIG_MBEDTLS_CERTIFICATE_BUNDLE_DEFAULT_FULL=n
CONFIG_MBEDTLS_CERTIFICATE_BUNDLE_DEFAULT_CMN=n

# Оптимизация NVS
CONFIG_NVS_ENCRYPTION=n

# Оптимизация LWIP
CONFIG_LWIP_MAX_SOCKETS=8
CONFIG_LWIP_SO_REUSE=y
CONFIG_LWIP_SO_REUSE_RXTOALL=n
CONFIG_LWIP_SO_RCVBUF=n
CONFIG_LWIP_DHCP_MAX_NTP_SERVERS=1
CONFIG_LWIP_DHCP_DOES_ARP_CHECK=n
CONFIG_LWIP_TCP_MSS=1440
CONFIG_LWIP_TCP_SND_BUF_DEFAULT=5744
CONFIG_LWIP_TCP_WND_DEFAULT=5744
CONFIG_LWIP_TCP_RECVMBOX_SIZE=6
CONFIG_LWIP_UDP_RECVMBOX_SIZE=6
CONFIG_LWIP_TCPIP_RECVMBOX_SIZE=32

# Оптимизация FreeRTOS
CONFIG_FREERTOS_ASSERT_ON_UNTESTED_FUNCTION=n
CONFIG_FREERTOS_CHECK_STACKOVERFLOW_NONE=y
CONFIG_FREERTOS_CHECK_STACKOVERFLOW_CANARY=n
CONFIG_FREERTOS_CHECK_STACKOVERFLOW_PTRVAL=n
CONFIG_FREERTOS_CHECK_MUTEX_GIVEN_BY_OWNER=n
CONFIG_FREERTOS_USE_TRACE_FACILITY=n
CONFIG_FREERTOS_USE_STATS_FORMATTING_FUNCTIONS=n
CONFIG_FREERTOS_GENERATE_RUN_TIME_STATS=n
CONFIG_FREERTOS_TASK_FUNCTION_WRAPPER=n
CONFIG_FREERTOS_WATCHPOINT_END_OF_STACK=n

# Оптимизация памяти приложений
CONFIG_ESP_MAIN_TASK_STACK_SIZE=3072
CONFIG_ESP_SYSTEM_EVENT_TASK_STACK_SIZE=1536
CONFIG_ESP_TIMER_TASK_STACK_SIZE=2048
CONFIG_ESP_INT_WDT_TIMEOUT_MS=800
CONFIG_ESP_TASK_WDT_TIMEOUT_S=10
CONFIG_ESP_TASK_WDT_CHECK_IDLE_TASK_CPU0=n
CONFIG_ESP_TASK_WDT_CHECK_IDLE_TASK_CPU1=n

# Отключение неиспользуемых функций
CONFIG_ESP32_ENABLE_COREDUMP_TO_NONE=y
CONFIG_ESP_COREDUMP_ENABLE_TO_NONE=y
CONFIG_ESP_ERR_TO_NAME_LOOKUP=n
CONFIG_ESP_SYSTEM_EVENT_QUEUE_SIZE=32
CONFIG_ESP_SYSTEM_EVENT_TASK_PRIORITY=5

