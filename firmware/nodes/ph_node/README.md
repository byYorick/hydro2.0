# pH Node

pH-нода для измерения pH и управления насосами кислоты/щелочи.

## Используемый сенсор

Нода использует **Trema pH-сенсор (iarduino)** через I²C:
- Компонент: `trema_ph`
- I²C адрес: 0x0A
- Поддержка калибровки (2 этапа)
- Автоматическая проверка стабильности измерений

## Описание

Нода измеряет pH раствора и может управлять насосами для корректировки pH (кислота/щелочь).

## Каналы

### Сенсоры
- `ph_sensor` - датчик pH

### Актуаторы
- `pump_acid` - насос кислоты
- `pump_base` - насос щелочи

## Команды

### run_pump
Запуск насоса на указанное время:
```json
{
  "cmd": "run_pump",
  "cmd_id": "cmd-123",
  "duration_ms": 2000
}
```

### calibrate
Калибровка pH датчика (2 этапа):
```json
{
  "cmd": "calibrate",
  "cmd_id": "cmd-124",
  "stage": 1,
  "ph_value": 7.0
}
```

Этапы калибровки:
- **Этап 1**: калибровка на pH 7.0 (нейтральный буфер)
- **Этап 2**: калибровка на pH 4.0 или 10.0 (кислый/щелочной буфер)

После отправки команды калибровки нода отвечает статусом ACK или ERROR.

## Документация

- Архитектура нод: `doc_ai/02_HARDWARE_FIRMWARE/NODE_ARCH_FULL.md`
- MQTT спецификация: `doc_ai/03_TRANSPORT_MQTT/MQTT_SPEC_FULL.md`
- NodeConfig: `firmware/NODE_CONFIG_SPEC.md`

