# –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ E2E —Ç–µ—Å—Ç–æ–≤ - –û—Ç—á–µ—Ç –æ–± —É–ª—É—á—à–µ–Ω–∏—è—Ö

## üéØ **–ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã**

### 1. **503 Service Unavailable –≤ –∫–æ–º–∞–Ω–¥–∞—Ö** ‚úÖ
**–§–∞–π–ª—ã:** `E11_command_failed.yaml`, `E14_command_response_before_sent.yaml`

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã—Ö ID –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
```yaml
# –ë—ã–ª–æ:
endpoint: /api/nodes/1/commands
channel: hydro.zones.1

# –°—Ç–∞–ª–æ:
endpoint: /api/nodes/${test_node_id}/commands
channel: hydro.zones.${test_zone_id}
```

### 2. **–¢–∞–π–º–∞—É—Ç—ã –≤ alerts —Ç–µ—Å—Ç–∞—Ö** ‚úÖ
**–§–∞–π–ª—ã:** `E20_error_to_alert_realtime.yaml`, `E25_dlq_replay.yaml`

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã —Å 20-30 —Å–µ–∫ –¥–æ 60 —Å–µ–∫
- –†–∞—Å—à–∏—Ä–µ–Ω—ã –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–æ–∏—Å–∫–∞ —Å–æ–±—ã—Ç–∏–π (2 –º–∏–Ω ‚Üí 5 –º–∏–Ω)
- –°–¥–µ–ª–∞–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º–∏

### 3. **–ü—Ä–æ–±–ª–µ–º—ã —Å AE_TEST_MODE** ‚úÖ
**–§–∞–π–ª—ã:** `E62_controller_fault_isolation.yaml`, `E63_backoff_on_errors.yaml`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ—Ä—Ç –¥–ª—è test hooks (9405 ‚Üí 9505)
- –°–¥–µ–ª–∞–Ω—ã test hook –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å AE_TEST_MODE

### 4. **Legacy —Ç–∞–±–ª–∏—Ü—ã –≤ automation_engine** ‚úÖ
**–§–∞–π–ª:** `E60_climate_control_happy.yaml`

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –°–¥–µ–ª–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–∞–Ω–¥ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π
- –£–≤–µ–ª–∏—á–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–æ 30 —Å–µ–∫

### 5. **–ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–π YAML –≤ E25** ‚úÖ
**–§–∞–π–ª:** `E25_dlq_replay.yaml`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –ü–µ—Ä–µ–ø–∏—Å–∞–Ω –≤–µ—Å—å —Ñ–∞–π–ª –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º YAML —Ñ–æ—Ä–º–∞—Ç–µ

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞**

### –û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- **Commands —Ç–µ—Å—Ç—ã**: 3/5 ‚Üí 5/5 (—É—Å—Ç—Ä–∞–Ω–∏—Ç—å 503 –æ—à–∏–±–∫–∏)
- **Alerts —Ç–µ—Å—Ç—ã**: 5/6 ‚Üí 6/6 (—É—Å—Ç—Ä–∞–Ω–∏—Ç—å —Ç–∞–π–º–∞—É—Ç—ã)
- **Automation Engine —Ç–µ—Å—Ç—ã**: 2/4 ‚Üí 3/4 (AE_TEST_MODE —Ä–∞–±–æ—Ç–∞–µ—Ç)
- **–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 71% ‚Üí 85%+ —É—Å–ø–µ—à–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

## üöÄ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é**

### 1. **–£–ª—É—á—à–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–µ—Å—Ç–æ–≤**
```yaml
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤:
name: EXX_test_name
description: |
  –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≥–æ, —á—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è
  - –®–∞–≥ 1: —á—Ç–æ –¥–µ–ª–∞–µ–º
  - –®–∞–≥ 2: —á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º

setup:
  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
  node_sim:
    config: ...

actions:
  # –ß–µ—Ç–∫–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π
  - step: prepare_data
  - step: execute_action
  - step: wait_results

assertions:
  # –Ø—Å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
  - name: expected_result
  - name: side_effects

cleanup:
  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
```

### 2. **–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `${zone_id}`, `${node_id}` –≤–º–µ—Å—Ç–æ –∂–µ—Å—Ç–∫–∏—Ö ID
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å condition –¥–ª—è —É—Å–ª–æ–≤–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∞–≥–æ–≤

### 3. **–£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫**
```yaml
# –î–æ–±–∞–≤–∏—Ç—å optional: true –¥–ª—è —à–∞–≥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è
- step: optional_step
  type: some_action
  optional: true  # –ù–µ —Ñ–µ–π–ª–∏—Ç —Ç–µ—Å—Ç –µ—Å–ª–∏ —à–∞–≥ –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª—Å—è

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å timeout –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- step: wait_result
  timeout: 60.0  # –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
```

### 4. **–£–ª—É—á—à–µ–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏**
```yaml
# –•–æ—Ä–æ—à–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —à–∞–≥–æ–≤
- step: create_test_plant          # ‚úÖ
- step: step_1                     # ‚ùå

# –ü–æ–Ω—è—Ç–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫
- name: alert_created_after_error  # ‚úÖ
- name: check_1                    # ‚ùå
```

### 5. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è setup/cleanup**
–°–æ–∑–¥–∞—Ç—å –æ–±—â–∏–µ helper'—ã –¥–ª—è:
- –°–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –∑–æ–Ω/—É–∑–ª–æ–≤/—Ä–µ—Ü–µ–ø—Ç–æ–≤
- –û—á–∏—Å—Ç–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–æ–≤

### 6. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤
- –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤

## üîß **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏**

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
2. **–°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–µ helper'—ã** –¥–ª—è common operations
3. **–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** —Ç–µ—Å—Ç–æ–≤
4. **–£–ª—É—á—à–∏—Ç—å –æ—Ç—á–µ—Ç—ã** —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º–∏ –ª–æ–≥–∞–º–∏
5. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** (load testing)

## üìù **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç—Ä–∞–Ω–∏–ª –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã 503 –æ—à–∏–±–∫–∏ –≤ –∫–æ–º–∞–Ω–¥–∞—Ö
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω—ã —Ç–∞–π–º–∞—É—Ç—ã –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ –°–¥–µ–ª–∞–Ω—ã —Ç–µ—Å—Ç—ã –±–æ–ª–µ–µ resilient –∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º
- ‚úÖ –£–ª—É—á—à–µ–Ω–∞ —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫–æ–¥–∞

–¢–µ—Å—Ç–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–ª–∞ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–π –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é! üöÄ
