2026-01-02T17:45:01.0138099Z ##[group]Run cp .env.example .env
2026-01-02T17:45:01.0138435Z [36;1mcp .env.example .env[0m
2026-01-02T17:45:01.0138677Z [36;1mphp artisan key:generate[0m
2026-01-02T17:45:01.0138913Z [36;1mphp -r "[0m
2026-01-02T17:45:01.0139103Z [36;1m  \$file = '.env';[0m
2026-01-02T17:45:01.0139351Z [36;1m  \$env = file_get_contents(\$file);[0m
2026-01-02T17:45:01.0139694Z [36;1m  // Используем in-memory cache в CI, чтобы не требовать таблицу cache[0m
2026-01-02T17:45:01.0140058Z [36;1m  if (preg_match('/^CACHE_STORE=.*/m', \$env)) {[0m
2026-01-02T17:45:01.0140448Z [36;1m    \$env = preg_replace('/^CACHE_STORE=.*/m', 'CACHE_STORE=array', \$env);[0m
2026-01-02T17:45:01.0140786Z [36;1m  } else {[0m
2026-01-02T17:45:01.0140997Z [36;1m    \$env .= PHP_EOL.'CACHE_STORE=array';[0m
2026-01-02T17:45:01.0141254Z [36;1m  }[0m
2026-01-02T17:45:01.0141471Z [36;1m  // Устанавливаем/обновляем параметры БД независимо от начальных значений[0m
2026-01-02T17:45:01.0141871Z [36;1m  \$env = preg_replace('/^DB_CONNECTION=.*/m', 'DB_CONNECTION=pgsql', \$env);[0m
2026-01-02T17:45:01.0142316Z [36;1m  if (preg_match('/^DB_DATABASE=.*/m', \$env)) {[0m
2026-01-02T17:45:01.0142694Z [36;1m    \$env = preg_replace('/^DB_DATABASE=.*/m', 'DB_DATABASE=hydro_test', \$env);[0m
2026-01-02T17:45:01.0143048Z [36;1m  } else {[0m
2026-01-02T17:45:01.0143264Z [36;1m    \$env .= PHP_EOL.'DB_DATABASE=hydro_test';[0m
2026-01-02T17:45:01.0143522Z [36;1m  }[0m
2026-01-02T17:45:01.0143729Z [36;1m  if (preg_match('/^DB_USERNAME=.*/m', \$env)) {[0m
2026-01-02T17:45:01.0144092Z [36;1m    \$env = preg_replace('/^DB_USERNAME=.*/m', 'DB_USERNAME=hydro', \$env);[0m
2026-01-02T17:45:01.0144620Z [36;1m  } else {[0m
2026-01-02T17:45:01.0144834Z [36;1m    \$env .= PHP_EOL.'DB_USERNAME=hydro';[0m
2026-01-02T17:45:01.0145078Z [36;1m  }[0m
2026-01-02T17:45:01.0145285Z [36;1m  if (preg_match('/^DB_PASSWORD=.*/m', \$env)) {[0m
2026-01-02T17:45:01.0145647Z [36;1m    \$env = preg_replace('/^DB_PASSWORD=.*/m', 'DB_PASSWORD=hydro', \$env);[0m
2026-01-02T17:45:01.0145965Z [36;1m  } else {[0m
2026-01-02T17:45:01.0146164Z [36;1m    \$env .= PHP_EOL.'DB_PASSWORD=hydro';[0m
2026-01-02T17:45:01.0146395Z [36;1m  }[0m
2026-01-02T17:45:01.0146589Z [36;1m  if (preg_match('/^DB_HOST=.*/m', \$env)) {[0m
2026-01-02T17:45:01.0146909Z [36;1m    \$env = preg_replace('/^DB_HOST=.*/m', 'DB_HOST=127.0.0.1', \$env);[0m
2026-01-02T17:45:01.0147208Z [36;1m  } else {[0m
2026-01-02T17:45:01.0147400Z [36;1m    \$env .= PHP_EOL.'DB_HOST=127.0.0.1';[0m
2026-01-02T17:45:01.0147624Z [36;1m  }[0m
2026-01-02T17:45:01.0147816Z [36;1m  if (preg_match('/^DB_PORT=.*/m', \$env)) {[0m
2026-01-02T17:45:01.0148119Z [36;1m    \$env = preg_replace('/^DB_PORT=.*/m', 'DB_PORT=5432', \$env);[0m
2026-01-02T17:45:01.0148408Z [36;1m  } else {[0m
2026-01-02T17:45:01.0148597Z [36;1m    \$env .= PHP_EOL.'DB_PORT=5432';[0m
2026-01-02T17:45:01.0148831Z [36;1m  }[0m
2026-01-02T17:45:01.0149011Z [36;1m  file_put_contents(\$file, \$env);[0m
2026-01-02T17:45:01.0149260Z [36;1m"[0m
2026-01-02T17:45:01.0195337Z shell: /usr/bin/bash -e {0}
2026-01-02T17:45:01.0195580Z env:
2026-01-02T17:45:01.0195755Z   COMPOSER_PROCESS_TIMEOUT: 0
2026-01-02T17:45:01.0195991Z   COMPOSER_NO_INTERACTION: 1
2026-01-02T17:45:01.0196209Z   COMPOSER_NO_AUDIT: 1
2026-01-02T17:45:01.0196577Z ##[endgroup]
2026-01-02T17:45:01.2499926Z 
2026-01-02T17:45:01.2500890Z    INFO  Application key set successfully.  
2026-01-02T17:45:01.2502335Z 
